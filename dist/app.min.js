!function(e){"use strict";e.module("cenkce.utils",["ng"]);e.module("cenkce.utils").service("utils.sharer",t),t.$inject=["$q"];function t(e){var t=e;this.fbfeed=function(e,n,o,r){var i=t.defer();return FB.ui({method:"feed",link:r,picture:o,description:n,caption:e},function(e){i.resolve(e)},function(e){i.reject(e)}),i.promise},this.fbshare=function(e){var n=t.defer();return FB.ui({method:"share",href:e},function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise},this.twshare=function(e,t){var n="http://twitter.com/home?status="+e+" "+t,o=window.open(n,"","height=600,width=800,resizable=true,scrollbars=yes,toolbar=no,menubar=no,location=no");window.focus&&o.focus()}}e.module("cenkce.utils").factory("utils.baseController",n),n.$inject=["$scope"];function n(e){var t=[];e.$on("$destroy",function(){for(var e in t)t[e].call()}),this.$on=function(e,n,o){t.push(e.$on(n,o))},this.$watch=function(e,n,o){t.push(e.$watch(n,o))}}r.$inject=["cenkce.imageFileReader","$rootScope","$window","$q"];var o={imageLoaded:"cropper:image-loaded",imageSelected:"cropper:image-selected",EXIFFetched:"cropper:exif-fetched",completed:"cropper:completed",cropped:"cropper:cropped"};function r(t,n,r,i){var c=this,a=r.cropper,s=!1,l={dragMode:"move",scalable:!1,aspectRatio:1,restore:!1,minCropBoxWidth:230,checkOrientation:!1,guides:!1,toggleDragModeOnDblclick:!1,center:!1,highlight:!1,cropBoxMovable:!1,cropBoxResizable:!1},d=new Image;if("undefined"==typeof Cropper)throw new Error("Croppperjs is not found.");function f(e){s=e}this.setElement=function(e){d=e},this.getElement=function(){return d},this.setConfig=function(t){l=e.copy(t)},this.getConfig=function(){e.copy(l)},this.exportData=function(){if(a){var e=";base64,",t={},n=new Image,o=a.getCroppedCanvas({width:w,height:h});return t.url=o.toDataURL("image/jpeg",1),n.src=t.url,t.url?(t.idx=t.url.indexOf(e),t.idx>=0&&(t.base64=t.url.substring(t.idx+e.length)),t.fileName=u()+".jpg",t):!1}};function p(e){var t=document.createElement("canvas");t.width=e.naturalWidth,t.height=e.naturalHeight;var n=t.getContext("2d");return n.drawImage(e,0,0),t.toDataURL()}this.zoomTo=function(e){a.zoomTo(e)},this.rotate=function(e){a.rotate(e)},this.getCropper=function(){return a},this.load=function(e){f(!0);var n=i.defer();if(l.cropend=function(e,t){},e.length>1)throw new Error("Multi-files are not supported");if(void 0===r.EXIF)throw new Error("exif-js cannot be found.");return t.read(e).then(function(t){if(!t[0].url)throw new Error("File data is not readable");d.src=t[0].url,d.onload=function(){f(!1),d.src=p(d),d.onload=function(){n.notify({message:o.imageLoaded,complete:function(){a=new Cropper(d,l),c.zoomTo(.5),EXIF.getData(e[0],function(){switch(n.notify({message:o.EXIFFetched}),this.exifdata.Orientation){case 8:a.rotate(-90);break;case 3:a.rotate(180);break;case 6:a.rotate(90)}n.notify({message:o.completed,complete:function(){n.resolve()}})})},cancel:function(){n.reject()}})}},d.src=t[0].url}),n.promise}}i.$inject=["cenkce.cropperService"];function i(t){var n,r=new Image;return t.setElement(r),{restrict:"A",controller:["$scope",function(e){e.$watch("zoom",function(t,n){t&&e.zoomTo(t)}),e.zoomTo=function(e){t.zoomTo(e)},e.exportCroppedData=function(e,n){t.exportData()},e.fileBrowse=function(){console.log("browse"),n[0].click()}}],controllerAs:"cropperCtrl",scope:!0,link:function(r,i,c){n=i.find("input[type=file]"),0==n.length&&(n=e.element("<input type='file' style=\"display: none;\" >"),i.append(n)),n.bind("change",function(e){t.load(e.target.files).then(function(e){console.log("completed")},function(e){},function(e){console.log("messages : ",e),e.message==o.imageLoaded?(r.addPreview(t.getElement()),e.complete()):e.message==o.completed&&e.complete()})}),r.$on("$destroy",function(){n.unbind("change"),n=null})}}}function c(){return{requie:"?cropper",restrict:"A",link:function(e,t,n){e.addPreview=function(e){t.html(""),t.append(e)}}}}e.module("cenkce.utils").service("cenkce.cropperService",r),e.module("cenkce.utils").directive("cropper",i),e.module("cenkce.utils").directive("cropperPreview",c),e.module("cenkce.utils").service("cenkce.ga",a),a.$inject=["$window"];function a(e){var t=e.ga;this.page=function(e){t("send",{hitType:"pageview",page:e})},this.event=function(e,n,o){t("send",{hitType:"event",eventCategory:e,eventAction:n,eventLabel:o})}}e.module("cenkce.utils").service("cenkce.generateUUID",u);function u(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}s.$inject=["$q"];function s(e){var t=e;this.read=function(e){for(var n,o=new FileReader,r=";base64,",i=[],c=0;n=e[c];c++){if(!n.type.match("image.*"))throw new Error("type must be image");var a=t.defer();i.push(a.promise),function(e,t){o.onload=function(n){var i={};o.readyState==FileReader.DONE&&(i.url=n.target.result,i.idx=i.url.indexOf(r),i.idx>=0&&(i.base64=i.url.substring(i.idx+r.length)),i.fileName=t.name),e.resolve(i)}}(a,n),o.readAsDataURL(n)}return t.all(i)}}e.module("cenkce.utils").service("cenkce.imageFileReader",s)}(window.angular);
//# sourceMappingURL=app.min.js.map
